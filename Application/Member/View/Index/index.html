<include file="Public:header"/>
<include file="Public:menu"/>


<div class="content-wrapper">
    <include file="Public:breadcrumb"/>

    <style>
        .le{margin-top: 30px;}
    </style>
    <!-- 日期-->

    <script src="{:ASSETS}plugins/jquery-validate/jquery.validate.min.js"></script>
    <script src="{:ASSETS}plugins/bootbox.js" type="text/javascript"></script>
    <script src="{:ASSETS}plugins/datepicker/bootstrap-datepicker.js" type="text/javascript"></script>
    <script src="{:ASSETS}plugins/datepicker/locales/bootstrap-datepicker.zh-CN.js" charset="UTF-8"></script>
    <link href="{:ASSETS}plugins/datepicker/datepicker3.css" rel="stylesheet" type="text/css" />
    <!-- jquery file upload -->
    <script src="{:ASSETS}plugins/jquery-file-upload/js/vendor/jquery.ui.widget.js" type="text/javascript"></script>
    <script src="{:ASSETS}plugins/jquery-file-upload/js/jquery.fileupload.js" type="text/javascript"></script>
    <link href="{:ASSETS}plugins/jquery-file-upload/css/jquery.fileupload.css" rel="stylesheet" type="text/css" />

    <form role="form" id="loginForm" class="form-horizontal" method="post" action="{:U('index/safe')}" >
    <section class="content">
        <div class="row">
            <div class="col-md-12">
                <div class="box box-primary">
                    <div class="box-header with-border">
                        <h3 class="box-title">个人信息维护及查询</h3>
                        <div class="box-tools pull-right">
                            <button data-widget="collapse" class="btn btn-box-tool"><i class="fa fa-minus"></i></button>
                        </div>
                    </div><!-- /.box-header -->
                    <div class="box-body ">
                        <input type="hidden" name="id" value="{$user_name.id}">
                        <div class="text-center">
                            <p> <span>您可以根要求填写个人的基本信息</span><br/>
                            <span>包括姓名，性别，身份证，照片，联系方式 ，电子邮箱等必填和选填项，在报名，复查前所有                                           信息<a>必须补充完整并经审核通过</a>
                                       </span>
                            </p>
                        </div>
                        <div class="le">
                            <h4>基本信息</h4>
                            <div class="box-body no-padding" >

                                    <div class="form-group">
                                        <label class="col-md-2 control-label">姓名</label>
                                        <div class="col-md-2">
                                            <input type="text" id="xm" disabled="true" name="xm" value="{$user_name['name']}" class="form-control">
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="col-md-2 control-label">身份证</label>
                                        <div class="col-md-2">
                                            <input type="text" id="ip" disabled="true" name="ip" value="{$user_name['identity']}" class="form-control">
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="col-md-2 control-label">报考专业</label>
                                        <div class="col-md-2">
                                            <input type="text" id="zy" disabled="true" value="{$sp_name}" class="form-control">
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="col-md-2 control-label">等级</label>
                                        <div class="col-md-1">

                                            <select disabled="true" id="dj" class="form-control w100 inline-block province"  name="dj">
                                                <option value="">{$le}</option>

                                            </select>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="col-md-2 control-label">性别：</label>
                                        <div class="col-md-2" id="sex">
                                            <select disabled="true" class="form-control w100 inline-block province"  name="sex">
                                                <option>{$sex}</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="col-md-2 control-label">民族</label>
                                        <div class="col-md-2">
                                            <input type="text" id="nation" name="nation" value="{$user_name['nation']}" class="form-control">
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="col-md-2 control-label">电子邮箱</label>
                                        <div class="col-md-2">
                                            <input type="text" id="email" name="email" value="{$user_name['email']}" class="form-control">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-md-2 control-label">现有职称</label>
                                        <div class="col-md-2" id="zhicheng">
                                            <select class="form-control w120 inline-block province"  name="zhicheng">
                                                <volist name="zhicheng" id="row">
                                                    <if condition="$i-1 eq $ti">
                                                        <option selected="selected" value="{$i-1}">{$row}</option>
                                                        <else/>
                                                        <option value="{$i-1}">{$row}</option>
                                                    </if>
                                                </volist>
                                            </select>
                                        </div>
                                    </div>

                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-12">
                                <div class="box box-primary">
                                    <div class="box-header with-border">
                                        <h3 class="box-title">个人信息</h3>
                                        <div class="box-tools pull-right">
                                            <button data-widget="collapse" class="btn btn-box-tool"><i class="fa fa-minus"></i></button>
                                        </div>
                                    </div>
                                    <div class="box-body">
                                        <div class="box-body no-padding" >

                                                <div class="form-group">
                                                    <label class="col-md-2 control-label">手机号</label>
                                                    <div class="col-md-2">
                                                        <input type="text" id="phone" name="phone" value="{$user_name['phone']}" class="form-control">
                                                    </div>
                                                </div>

                                                <div class="form-group">
                                                    <label class="col-md-2 control-label">第一学历</label>
                                                    <div class="col-md-2" id="educational">
                                                        <select class="form-control w100 inline-block province"  name="educational">
                                                <volist name="educational" id="row">
                                                    <if condition="$user_name['educational'] eq $i-1">
                                                        <option selected="selected" value="{$i-1}">{$row}</option><else/><option value="{$i-1}">{$row}</option>
                                                    </if>
                                                </volist>

                                                        </select>

                                                    </div>
                                                </div>

                                                <div class="form-group">
                                                    <label class="col-md-2 control-label">毕业院校</label>
                                                    <div class="col-md-2">
                                                        <input type="text" id="school" name="school" value="{$user_name['school']}" class="form-control">
                                                    </div>
                                                </div>

                                                <div class="form-group">
                                                    <label class="col-md-2 control-label">毕业时间</label>
                                                    <div class="col-md-2" >
                                                        <input type="text" name="graduation_date" id="begin-time" value="{$user_name['graduation_date']}" class="form-control inline-block province" onclick="return selectDate(this, 'begin-time')">
                                                    </div>

                                                </div>

                                                <div class="form-group">
                                                    <label class="col-md-2 control-label">行政职业</label>
                                                    <div class="col-md-2">
                                                        <input type="text" id="duty" name="duty" value="{$user_name['duty']}" class="form-control">
                                                    </div>
                                                </div>

                                                <div class="form-group">
                                                    <label  class="col-md-2 control-label">上传图片</label>
                                                    <div class="input-group" style="position: relative; left: 15px;">
                                                        <input type="text" readonly="readonly" name="thumb" style="width: 150px;"  class="form-control" id="uiFileUploadInput1" data-thumb="" value="{$user_name['thumb']}">

                                                        <button onclick="upload1()" type="button" class="btn btn-success btn-flat"><i class="fa fw fa-plus-circle"></i></button>
                                                    </div>

                                                </div>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="box-footer text-center">
                            <button type="submit" onclick="return login()" class="btn btn-success pull-left">保存</button>
                        </div><!-- /.box-footer -->

                    </div>
                </div>
            </div>
        </div>
    </section>
    </form>
</div>
<!-- 上传图片模态框 基本信息 -->
<div class="modal fade " id="imageUploadModal1" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                        aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="">上传图片</h4>
            </div>
            <div class="modal-body no-padding maxh500">
                <div class="images-zone tc thumb-place-holder">

                </div>
            </div>
            <div class="modal-footer">
                <div class="pull-left" style="">
                    <div class="btn btn-success fileinput-button pull-left inline-block">
                        <i class="glyphicon glyphicon-plus"></i>
                        <span>添加图片...</span>
                        <input id="fileupload1" type="file" name="files" multiple="" data-text-control="#uiFileUploadInput1">
                    </div>
                    <span class="loading action-doing hide inline-block mt5 ml10"><i class="fa fa-refresh fa-spin"></i>&nbsp;文件上传中...</span>
                    <span class="loading action-done hide inline-block mt5 ml10"><i class="fa fa-check-circle-o"></i>&nbsp;上传成功</span>
                </div>
                <button type="button" class="btn btn-default ml20" data-dismiss="modal">保存</button>
            </div>
        </div>
    </div>
</div>

<!-- form validate -->
<script src="{:ASSETS}/plugins/jquery-validate/jquery.validate.min.js"></script>
<script src="{:ASSETS}/plugins/jquery-validate/additional-methods.min.js"></script>
<script type="text/javascript">

    function upload1() {
        $('#imageUploadModal1').modal({});
    }
    //选择日期
    function selectDate(o, id) {
        var _id = '#' + id;
        $(_id).datepicker({
            format: 'yyyy-mm-dd',
            language: 'zh-CN'
        }).on("changeDate", function(e) {
            var me = e.target;
            $(this).datepicker('hide');
        });

        $(_id).datepicker('show');
    }
    var file_url = "{:U('member/index/jqueryFileUpload')}";


    function show_img(id_1,id_2) {
        $(id_1).fileupload({
            //options
            url: file_url,
            dataType: 'json',
            autoUpload: true,
            acceptFileTypes: /(\.|\/)(gif|jpe?g|png)$/i,
            maxFileSize: 999000,
            //event
            add: function (e, data) {
                //指定模态框容器
                data.context = $(id_2);
                var autoUpload = $.blueimp.fileupload.prototype.options.autoUpload;
                if (autoUpload) {
                    data.submit();
                    data.context.find(".action-doing").removeClass("hide");
                }
                return true;
            },

            progressall: function (e, data) {
                //进度条
                var progress = parseInt(data.loaded / data.total * 100, 10);
            },

            done: function (e, data) {
                var fileInput = data.fileInput;
                var inputTextId = fileInput.attr("data-text-control");
                var inputText = $(inputTextId);
                var placeHolder = data.context.find(".thumb-place-holder");
                placeHolder.html("");
                $.each(data.result.files, function (index, file) {
                    if (file.thumbnailUrl) {

                        $("<img>").attr("src", file.thumbnailUrl).appendTo(placeHolder);
                        inputText.val(file.url);
                        inputText.attr("data-thumb", file.thumbnailUrl);
                    }
                });

                data.context.find(".action-doing").addClass("hide");
                data.context.find(".action-done").removeClass("hide");

            }

        });
    }
    show_img("#fileupload1","#imageUploadModal1");

    </script>
<!--表单验证-->
    <script>
        // 移动电话号码验证
        jQuery.validator.addMethod("isPhone", function(value, element) {
            var reg = /^1[34578]\d{9}$/;
            return this.optional(element) || (reg.test(value));
        }, "* 请填写正确格式手机号码");

        // 身份证号码验证
        jQuery.validator.addMethod("isIDCard", function(value, element) {
            var reg = /(^\d{15}$)|(^\d{17}([0-9]|X)$)/;
            return this.optional(element) || (reg.test(value));
        }, "* 请填写正确格式身份证号码");


        function login() {

        <!--验证不能为空-->
        $("#loginForm").validate({
            rules: {
                phone: {
                    required: true,
                    isPhone: true
                },
                email: {
                    email:true,
                    required: true,
                }
            },
            messages: {
                phone:{
                    required: "* 手机号码不能为空",
                    isPhone: "* 手机号码格式不正确"
                },
                email: {
                    email:'邮箱格式不正确',
                    required: '* 邮箱不能为空',
                }
            },

        });
            return true;
    }
    </script>


<include file="Public:footer"/>